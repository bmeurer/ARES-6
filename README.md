# ARES-6

## About the Tests

ARES-6 measures the execution time of JavaScript’s newest features, including symbols, for-of, arrow functions, Map/Set/WeakMap, let/const, classes, proxies, string interpolation, destructuring, default arguments, spread, tail calls, and generators. ARES-6 is comprised of four sub-tests: Air, Basic, Babylon, and ML.

Air is an ES2015 port of the [WebKit B3 JIT](https://webkit.org/blog/5852/introducing-the-b3-jit-compiler/)’s [`Air::allocateStack` phase](https://trac.webkit.org/changeset/201783). This code is a heavy user of Map, Set, classes, spread, and for-of. The benchmark runs `allocateStack` on hot function bodies from other popular JavaScript benchmarks: `executeIteration` from [Octane](https://developers.google.com/octane/)/Gameboy, `gaussianBlur` from [Kraken](http://krakenbenchmark.mozilla.org/), and `scanIdentifier` from Octane/Typescript. Air also runs `allocateStack` on a hot function from Air itself. [Browse the source](https://trac.webkit.org/browser/trunk/PerformanceTests/ARES-6/Air?rev=211697).

Basic is an [ES2015 implementation](https://trac.webkit.org/changeset/202446) of the [ECMA-55 BASIC standard](http://www.ecma-international.org/publications/files/ECMA-ST-WITHDRAWN/ECMA-55,%201st%20Edition,%20January%201978.pdf). BASIC was an interactive language from the start, so our implementation uses generator functions for the entire interpreter. When the BASIC program says `INPUT`, our interpreter says `yield`. This allows users of the interpreter to easily integrate it into a runloop. Basic also uses classes, Map, and WeakMap. The benchmark runs a handful of simple programs, the most complex of which finds prime numbers. [Browse the source](https://trac.webkit.org/browser/trunk/PerformanceTests/ARES-6/Basic?rev=211697&order=name).

[Babylon](https://github.com/babel/babylon) is an implementation of a parser for the JavaScript language. Babylon is the parser used in the [Babel](https://babeljs.io/) JavaScript transpiler. The benchmark runs the Babylon parser on four different JavaScript sources. Babylon makes heavy use of classes, does non trivial string processing, and creates non-trivial object graphs.

[ML](https://github.com/mljs/feedforward-neural-networks) is an implementation of a [feedforward neural network](https://en.wikipedia.org/wiki/Feedforward_neural_network). The benchmark trains several networks using different [activation functions](https://en.wikipedia.org/wiki/Activation_function) and several sample data sets. ML makes heavy use of classes. It relies on the [ml-matrix](https://github.com/mljs/matrix) library and does non-trivial matrix math.

ARES-6 rewards browsers that start up quickly and run smoothly. It's not enough to just measure the total running time of a workload. Browsers may perform differently for the same workload depending on how many times it has run. Garbage collection runs periodically, making some iterations take longer than others. Code that runs repeatedly gets optimized by the browser, so the first iteration of any workload is more expensive than the rest. ARES-6 runs Air, Basic, and Babylon for 200 iterations, and ML for 60 iterations, and reports the execution time of the first iteration, the average of the 4 worst iterations, and the overall geometric mean. Each of these values is given an equal weight when computing the ovarall time. ARES-6 equally rewards fast start-up, low jank, and sophisticated adaptive optimizations for long-running code.

Each ARES-6 sample has 200 iterations of Air, Basic, and Babylon, and 60 iterations of ML. ARES-6 runs 6 samples, and reports the average with 95% confidence intervals. Each sample runs in a fresh `iframe` to simulate some of the effects of page navigation.
